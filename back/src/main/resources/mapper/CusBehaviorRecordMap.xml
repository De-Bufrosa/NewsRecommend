<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.smacul.demo.dao.CusBehaviorRecordDao">

    <insert id="addTargetCusFollowBehavior">
        insert into CusBehaviorRecord(cbr_cus_id_from, cbr_cus_id_to, cbr_behavior)
        values (#{param1}, #{param2}, 11)
    </insert>

    <insert id="addCusBehavior">
        insert into CusBehaviorRecord(cbr_cus_id_from, cbr_cus_id_to, cbr_behavior, cbr_art_id, cbr_type, cbr_target_id)
        values (#{cusIdFrom}, #{cusIdTo}, #{behavior}, #{artId}, #{type}, #{targetId})
    </insert>

    <delete id="deleteTargetCusFollowBehavior">
        delete from CusBehaviorRecord
        where cbr_behavior = 11 and cbr_cus_id_from = #{param1} and cbr_cus_id_to = #{param2};
    </delete>

    <delete id="deleteCusBehavior">
        delete from CusBehaviorRecord
        where
            cbr_cus_id_from = #{cusIdFrom} and cbr_cus_id_to = #{cusIdTo} and cbr_behavior = #{behavior} and
            cbr_art_id = #{artId} and cbr_type = #{type} and cbr_target_id = #{targetId}
    </delete>


    <select id="countTargetCusFollowBehavior" resultType="java.lang.Integer">
        select count(*)
        from CusBehaviorRecord
        where cbr_behavior = 11 and cbr_cus_id_from = #{param1} and cbr_cus_id_to = #{param2};
    </select>

    <select id="countCusBehaviorFrom" resultType="java.lang.Integer">
        select count(*)
        from CusBehaviorRecord
        where cbr_cus_id_from = #{param1} and cbr_behavior = #{param2}
    </select>

    <select id="countCusBehaviorTo" resultType="java.lang.Integer">
        select count(*)
        from CusBehaviorRecord
        where cbr_cus_id_to = #{param1} and cbr_behavior = #{param2}
    </select>

    <select id="countTargetCusArtBehaviorFrom" resultType="java.lang.Integer">
        select count(*)
        from CusBehaviorRecord
        where
            cbr_cus_id_from = #{cusIdFrom} and cbr_art_id = #{artId}
            and cbr_behavior = #{behavior} and cbr_type = 1 and cbr_target_id = #{artId}
    </select>

    <select id="countTargetCusArtBehaviorTo" resultType="java.lang.Integer">
        select count(*)
        from CusBehaviorRecord
        where
            cbr_cus_id_to = #{cusIdTo} and cbr_art_id = #{artId}
            and cbr_behavior = #{behavior} and cbr_type = 1 and cbr_target_id = #{artId}
    </select>

    <select id="getCusBehaviorRecordByCusId" resultType="com.smacul.demo.bean.CusBehaviorRecord">
--         select *
--         from CusBehaviorRecord
--         where cbr_cus_id_from
    </select>

    <!--    <select id="countCusWithArtCusFollowBehavior" resultType="java.lang.Integer">-->
<!--        select count(*)-->
<!--        from CusBehaviorRecord left join (select art_id from Article where art_cus_id = #{cusId}) on cbr_art_id = art_id-->
<!--        where cbr_cus_id_from = #{cusId}-->
<!--    </select>-->


</mapper>